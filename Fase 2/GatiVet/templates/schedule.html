{% extends "base.html" %}

{% block title %}Contacto{% endblock %}

{% block content %}

<!-- Body-->
<body class="bg-gray-100">
    <div class="max-w-4xl mx-auto my-10 p-6 bg-white shadow-md rounded-lg">
        <!-- Pasos de progreso -->
        <div class="step-container">
            <div class="step-wrapper">
                <!-- Primer paso: Identificación -->
                <div class="flex flex-col items-center">
                    <i class="fas fa-id-card step-icon" id="id-icon"></i>
                    <span class="step-icon-name text-sm" id="id-icon-name">Identificación</span>
                </div>
                <div class="flex flex-col items-center">
                    <i class="fas fa-search step-icon" id="search-icon"></i>
                    <span class="step-icon-name text-sm" id="search-icon-name">Buscar</span>
                </div>
                <div class="flex flex-col items-center">
                    <i class="fas fa-check step-icon" id="select-icon"></i>
                    <span class="step-icon-name text-sm" id="select-icon-name">Seleccionar Fecha y Hora</span>
                </div>
                <div class="flex flex-col items-center">
                    <i class="fas fa-thumbs-up step-icon" id="success-icon"></i>
                    <span class="step-icon-name text-sm" id="success-icon-name">Éxito</span>
                </div>
            </div>
        </div>

        <!-- Form Sections -->
        <div id="form-steps">
            <!-- Identificación -->
            <div class="step-content p-6 bg-white shadow-md rounded-lg active" id="step-id">
                <h2 class="text-3xl font-bold text-gray-800 mb-6">Identificación</h2>
                <p class="text-gray-700 mb-4">Ingrese su RUT para continuar:</p>
                <input type="text" id="rut-input" placeholder="Ingrese su RUT"
                       class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400 mb-4">
                <div class="text-center mt-6">
                    <button onclick="
                        const rut = document.getElementById('rut-input').value;
                        if (!rut) {
                            alert('Por favor, ingrese su RUT.');
                            return;
                        }
                        nextStep('step-id', 'step-search', 'id-icon');
                    "
                    class="px-6 py-3 bg-[#18beaa] hover:bg-[#16a89a] text-white font-semibold rounded-lg shadow-md focus:outline-none focus:ring-2 focus:ring-green-400 focus:ring-opacity-75 transition duration-300 ease-in-out transition-transform transform-gpu hover:-translate-y-1 hover:shadow-lg cursor-pointer">
                        Siguiente
                    </button>
                </div>
            </div>
            <!-- Fin identificación -->

            <!-- Búsqueda -->
            <div class="step-content hidden p-6 bg-white shadow-md rounded-lg" id="step-search">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 items-start">
                    <!-- Selección de Área -->
                    <div class="col-span-1 mb-6">
                        <h3 class="text-xl font-semibold text-gray-700 mb-3">Seleccionar área:</h3>
                        <select id="area-select"
                                class="block w-full border border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                            <option value="general">Consulta General</option>
                            <option value="especialidad">Consulta Especialidad Felina</option>
                            <option value="telemedicina">Consulta Telemedicina</option>
                        </select>
                    </div>

                    <!-- Contenedor para Divisor Vertical y Buscar por -->
                    <div class="col-span-2 flex flex-col mb-6">
                        <div class="flex items-start mb-6">
                            <!-- Divisor Vertical -->
                            <div class="hidden md:block w-px h-40 bg-gray-300 mr-6"></div>

                            <!-- Buscar por -->
                            <div class="w-full">
                                <h3 class="text-xl font-semibold text-gray-700 mb-3">Buscar por:</h3>
                                <div class="flex space-x-4 mb-4">
                                    <label class="inline-flex items-center">
                                        <input type="radio" name="search-type" value="staff" onclick="toggleSearch('staff-search')"
                                               class="form-radio text-blue-500 border-gray-300 focus:border-blue-500 focus:ring-blue-500">
                                        <span class="ml-2 text-gray-700">Staff</span>
                                    </label>
                                </div>

                                <!-- Búsqueda por Servicio y Staff en una fila -->
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <!-- Búsqueda por Servicio para el futuro -->
                                    <div id="service-search" class="hidden">
                                        <!-- Añadir más opciones según sea necesario -->
                                    </div>

                                    <!-- Búsqueda por Staff -->
                                    <div id="staff-search" class="hidden">
                                        <h3 class="text-xl font-semibold text-gray-700 mb-2">Seleccionar Doctor:</h3>
                                        <select id="staff-select"
                                                class="block w-full border border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50"
                                                onchange="updateDoctorInfoFromSelection()">
                                            <option value="none" selected>Seleccione un doctor</option>
                                            <option value="doctor1" data-name="Dr. Nicolás Villalba"
                                                    data-image="static/img/doctor1.jpg">Dr. Nicolás Villalba</option>
                                            <option value="doctor2" data-name="Dra. Kirito Aravena"
                                                    data-image="static/img/doctor2.jpg">Dra. Kirito Aravena</option>
                                            <!-- Añadir más opciones según sea necesario -->
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Botón principal "Pedir Hora" -->
                <div class="text-center mt-6">
                    <button onclick="
                        const doctorSelected = document.getElementById('staff-select').value;
                        if (!doctorSelected || doctorSelected === 'none') {
                            alert('Por favor, seleccione un doctor.');
                            return;
                        }
                        nextStep('step-search', 'step-select', 'search-icon');
                    "
                    class="px-6 py-3 bg-[#18beaa] hover:bg-[#16a89a] text-white font-semibold rounded-lg shadow-md focus:outline-none focus:ring-2 focus:ring-green-400 focus:ring-opacity-75 transition duration-300 ease-in-out transition-transform transform-gpu hover:-translate-y-1 hover:shadow-lg cursor-pointer">
                        Pedir Hora
                    </button>
                </div>
            </div>
            <!-- Fin búsqueda -->

            <!-- Selección -->
            <div class="step-content hidden p-6 bg-white shadow-md rounded-lg" id="step-select">
                <p class="text-gray-700 mb-4">Seleccione la fecha y hora para su cita con el profesional seleccionado:</p>

                <div class="flex items-start">
                    <!-- Imagen del Doctor Seleccionado -->
                    <div class="w-1/3 mr-6 text-center">
                        <img id="doctor-image" src="static/img/Logo Gativet.png" alt="Imagen del Doctor"
                             class="w-full h-auto rounded-lg shadow-md">
                        <!-- Nombre del Doctor -->
                        <p id="doctor-name" class="mt-2 text-gray-800 font-semibold">Nombre del Doctor</p>
                    </div>

                    <!-- Selección de Fecha y Horas Disponibles -->
                    <div class="w-2/3">
                        <!-- Selección de Fecha -->
                        <div class="mb-4">
                            <label for="date-select" class="block text-gray-700 mb-2">Selecciona una fecha:</label>
                            <input type="date" id="date-select"
                                   class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-green-400">
                        </div>

                        <!-- Selección de Hora -->
                        <div class="mb-4">
                            <label for="time-select" class="block text-gray-700 mb-2">Horas disponibles:</label>
                            <div id="time-select" class="flex flex-wrap gap-2">
                                <!-- Botones de Hora -->
                                <button type="button" class="time-slot px-4 py-2 bg-gray-200 border rounded-lg hover:bg-gray-300"
                                        onclick="selectTime(this)">09:00</button>
                                <button type="button" class="time-slot px-4 py-2 bg-gray-200 border rounded-lg hover:bg-gray-300"
                                        onclick="selectTime(this)">10:00</button>
                                <!-- Más botones según necesidad -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Botón principal "Confirmar Cita" -->
                <div class="text-center mt-6">
                    <button onclick="
                        const dateSelected = document.getElementById('date-select').value;
                        const timeSelected = document.querySelector('#time-select button.bg-green-400');
                        if (!dateSelected) {
                            alert('Por favor, seleccione una fecha.');
                            return;
                        }
                        if (!timeSelected) {
                            alert('Por favor, seleccione una hora.');
                            return;
                        }
                        nextStep('step-select', 'step-success', 'select-icon');
                    "
                    class="px-6 py-3 bg-[#18beaa] hover:bg-[#16a89a] text-white font-semibold rounded-lg shadow-md focus:outline-none focus:ring-2 focus:ring-green-400 focus:ring-opacity-75 transition duration-300 ease-in-out transition-transform transform-gpu hover:-translate-y-1 hover:shadow-lg cursor-pointer">
                        Confirmar Cita
                    </button>
                </div>
            </div>
            <!-- Fin selección -->

            <!-- Éxito -->
            <div class="step-content hidden p-6 bg-white shadow-md rounded-lg" id="step-success">
                <h2 class="text-3xl font-bold text-gray-800 mb-6">¡Éxito!</h2>
                <p class="text-gray-700">Tu cita ha sido programada exitosamente.</p>
                <div class="text-center mt-6">
                    <button onclick="location.reload();"
                            class="px-6 py-3 bg-[#18beaa] hover:bg-[#16a89a] text-white font-semibold rounded-lg shadow-md focus:outline-none focus:ring-2 focus:ring-green-400 focus:ring-opacity-75 transition duration-300 ease-in-out transition-transform transform-gpu hover:-translate-y-1 hover:shadow-lg cursor-pointer">
                        Volver al Inicio
                    </button>
                </div>
            </div>
            <!-- Fin éxito -->

        </div>
    </div>
</body>

<script>
    function nextStep(currentStepId, nextStepId, currentIconId) {
        document.getElementById(currentStepId).classList.add('hidden');
        document.getElementById(nextStepId).classList.remove('hidden');
        document.getElementById(currentIconId).classList.add('text-green-500');
    }

    function selectTime(button) {
        let buttons = document.querySelectorAll('#time-select button');
        buttons.forEach(b => b.classList.remove('bg-green-400', 'text-white'));
        button.classList.add('bg-green-400', 'text-white');
    }

    function toggleSearch(searchType) {
        document.getElementById('service-search').classList.add('hidden');
        document.getElementById('staff-search').classList.add('hidden');

        if (searchType === 'staff-search') {
            document.getElementById('staff-search').classList.remove('hidden');
        } else if (searchType === 'service-search') {
            document.getElementById('service-search').classList.remove('hidden');
        }
    }

    function updateDoctorInfoFromSelection() {
        const selectedOption = document.querySelector('#staff-select option:checked');
        const doctorName = selectedOption.getAttribute('data-name');
        const doctorImage = selectedOption.getAttribute('data-image');

        if (doctorName) {
            document.getElementById('doctor-name').textContent = doctorName;
        }

        if (doctorImage) {
            document.getElementById('doctor-image').src = doctorImage;
        }
    }

    function validateDateSelection() {
        const dateInput = document.getElementById('date-select');
        if (dateInput.value) {
            dateInput.classList.remove('border-red-500');
        }
    }
</script>

{% endblock %}
